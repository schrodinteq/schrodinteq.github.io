<!DOCTYPE html>
<html lang="japanese">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>AWSのAmazon Braketでショアのアルゴリズム | Schrodin&#39;s Diary on Quantum Computing and Quantum Programming</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="これまでの記事では以下の内容を学びました：
量子フーリエ変換を具体例で理解 Qiskit 2.0で逆量子フーリエ変換 Amazon Braket SDKで逆量子フーリエ変換 Qiskit 2.0で量子位相推定 Amazon Braket SDKで量子位相推定 これらを踏まえてRSA暗号や、ビットコインのトランザクションで利用されるECDSA暗号を破ると言われている量子アルゴリズムであるショアのアルゴリズムについて学びます。
Amazon Braket学習コース この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。
https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8 量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。 こちらも利用し、量子技術のスキルを身につけましょう！
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 ショアのアルゴリズム 量子コンピューターで十分な数の量子ビットが扱えるようになった場合、ショアのアルゴリズムでRSA暗号や、ECDSA暗号が破られる危険性があると言われています。 例えばRSA暗号は大きな数の素因数分解が困難であることを利用した暗号方式ですが、今回はショアのアルゴリズムで素因数分解を行う例についてみていきましょう。 このアルゴリズムを用いて整数$N$の素因数分解を行う際の流れは以下の通りです。 $1 &lt; a &lt; N$ かつ$ N$との最大公約数が $1$ となる$a$を選ぶ $\downarrow$ $a^x\bmod\ N$ という関数の周期 $r$を見つける $\downarrow$ $a^{\frac{r}{2}} \pm 1$の最大公約数からNの素因数を求める ここで&quot;$a^x\bmod\ N$ という関数の周期 $r$を見つける&quot;と記載されていますが、具体例を見ていきましょう。
例として$N=39$を素因数分解する際に、$a=5$を選んだ場合について考えます。$a^x\bmod\ N\ =\ 5^x\bmod\ 39$のグラフは$x$を横軸とすると次の通りとなります。
y軸の値を書き出すと以下の通りで、4回の変化を通じて元の値に戻る周期関数であることがわかります。
$$ 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \rightarrow 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \tag{1} $$">
    <meta name="generator" content="Hugo 0.128.1">
    
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.13b1b261ee5e4804730aaa2e64ba98f5872177502bbdaf7119319dd9331c082e.css" >



    
    <script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']]
  },
  svg: {
    fontCache: 'global'
  }
};
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>


<link rel="stylesheet" href="/css/_styles.css">

    
      

    

    

    
      <link rel="canonical" href="https://schrodinteq.github.io/japanese/awsbraketshor/">
    

    <meta property="og:url" content="https://schrodinteq.github.io/japanese/awsbraketshor/">
  <meta property="og:site_name" content="Schrodin&#39;s Diary on Quantum Computing and Quantum Programming">
  <meta property="og:title" content="AWSのAmazon Braketでショアのアルゴリズム">
  <meta property="og:description" content="これまでの記事では以下の内容を学びました：
量子フーリエ変換を具体例で理解 Qiskit 2.0で逆量子フーリエ変換 Amazon Braket SDKで逆量子フーリエ変換 Qiskit 2.0で量子位相推定 Amazon Braket SDKで量子位相推定 これらを踏まえてRSA暗号や、ビットコインのトランザクションで利用されるECDSA暗号を破ると言われている量子アルゴリズムであるショアのアルゴリズムについて学びます。
Amazon Braket学習コース この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。
https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8 量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。 こちらも利用し、量子技術のスキルを身につけましょう！
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 ショアのアルゴリズム 量子コンピューターで十分な数の量子ビットが扱えるようになった場合、ショアのアルゴリズムでRSA暗号や、ECDSA暗号が破られる危険性があると言われています。 例えばRSA暗号は大きな数の素因数分解が困難であることを利用した暗号方式ですが、今回はショアのアルゴリズムで素因数分解を行う例についてみていきましょう。 このアルゴリズムを用いて整数$N$の素因数分解を行う際の流れは以下の通りです。 $1 &lt; a &lt; N$ かつ$ N$との最大公約数が $1$ となる$a$を選ぶ $\downarrow$ $a^x\bmod\ N$ という関数の周期 $r$を見つける $\downarrow$ $a^{\frac{r}{2}} \pm 1$の最大公約数からNの素因数を求める ここで&#34;$a^x\bmod\ N$ という関数の周期 $r$を見つける&#34;と記載されていますが、具体例を見ていきましょう。
例として$N=39$を素因数分解する際に、$a=5$を選んだ場合について考えます。$a^x\bmod\ N\ =\ 5^x\bmod\ 39$のグラフは$x$を横軸とすると次の通りとなります。
y軸の値を書き出すと以下の通りで、4回の変化を通じて元の値に戻る周期関数であることがわかります。
$$ 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \rightarrow 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \tag{1} $$">
  <meta property="og:locale" content="japanese">
  <meta property="og:type" content="article">
    <meta property="article:published_time" content="2025-07-20T12:00:33+09:00">
    <meta property="article:modified_time" content="2025-07-20T12:00:33+09:00">

  <meta itemprop="name" content="AWSのAmazon Braketでショアのアルゴリズム">
  <meta itemprop="description" content="これまでの記事では以下の内容を学びました：
量子フーリエ変換を具体例で理解 Qiskit 2.0で逆量子フーリエ変換 Amazon Braket SDKで逆量子フーリエ変換 Qiskit 2.0で量子位相推定 Amazon Braket SDKで量子位相推定 これらを踏まえてRSA暗号や、ビットコインのトランザクションで利用されるECDSA暗号を破ると言われている量子アルゴリズムであるショアのアルゴリズムについて学びます。
Amazon Braket学習コース この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。
https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8 量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。 こちらも利用し、量子技術のスキルを身につけましょう！
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 ショアのアルゴリズム 量子コンピューターで十分な数の量子ビットが扱えるようになった場合、ショアのアルゴリズムでRSA暗号や、ECDSA暗号が破られる危険性があると言われています。 例えばRSA暗号は大きな数の素因数分解が困難であることを利用した暗号方式ですが、今回はショアのアルゴリズムで素因数分解を行う例についてみていきましょう。 このアルゴリズムを用いて整数$N$の素因数分解を行う際の流れは以下の通りです。 $1 &lt; a &lt; N$ かつ$ N$との最大公約数が $1$ となる$a$を選ぶ $\downarrow$ $a^x\bmod\ N$ という関数の周期 $r$を見つける $\downarrow$ $a^{\frac{r}{2}} \pm 1$の最大公約数からNの素因数を求める ここで&#34;$a^x\bmod\ N$ という関数の周期 $r$を見つける&#34;と記載されていますが、具体例を見ていきましょう。
例として$N=39$を素因数分解する際に、$a=5$を選んだ場合について考えます。$a^x\bmod\ N\ =\ 5^x\bmod\ 39$のグラフは$x$を横軸とすると次の通りとなります。
y軸の値を書き出すと以下の通りで、4回の変化を通じて元の値に戻る周期関数であることがわかります。
$$ 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \rightarrow 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \tag{1} $$">
  <meta itemprop="datePublished" content="2025-07-20T12:00:33+09:00">
  <meta itemprop="dateModified" content="2025-07-20T12:00:33+09:00">
  <meta itemprop="wordCount" content="396">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="AWSのAmazon Braketでショアのアルゴリズム">
  <meta name="twitter:description" content="これまでの記事では以下の内容を学びました：
量子フーリエ変換を具体例で理解 Qiskit 2.0で逆量子フーリエ変換 Amazon Braket SDKで逆量子フーリエ変換 Qiskit 2.0で量子位相推定 Amazon Braket SDKで量子位相推定 これらを踏まえてRSA暗号や、ビットコインのトランザクションで利用されるECDSA暗号を破ると言われている量子アルゴリズムであるショアのアルゴリズムについて学びます。
Amazon Braket学習コース この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。
https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8 量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。 こちらも利用し、量子技術のスキルを身につけましょう！
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。
はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】 ショアのアルゴリズム 量子コンピューターで十分な数の量子ビットが扱えるようになった場合、ショアのアルゴリズムでRSA暗号や、ECDSA暗号が破られる危険性があると言われています。 例えばRSA暗号は大きな数の素因数分解が困難であることを利用した暗号方式ですが、今回はショアのアルゴリズムで素因数分解を行う例についてみていきましょう。 このアルゴリズムを用いて整数$N$の素因数分解を行う際の流れは以下の通りです。 $1 &lt; a &lt; N$ かつ$ N$との最大公約数が $1$ となる$a$を選ぶ $\downarrow$ $a^x\bmod\ N$ という関数の周期 $r$を見つける $\downarrow$ $a^{\frac{r}{2}} \pm 1$の最大公約数からNの素因数を求める ここで&#34;$a^x\bmod\ N$ という関数の周期 $r$を見つける&#34;と記載されていますが、具体例を見ていきましょう。
例として$N=39$を素因数分解する際に、$a=5$を選んだ場合について考えます。$a^x\bmod\ N\ =\ 5^x\bmod\ 39$のグラフは$x$を横軸とすると次の通りとなります。
y軸の値を書き出すと以下の通りで、4回の変化を通じて元の値に戻る周期関数であることがわかります。
$$ 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \rightarrow 1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \tag{1} $$">

      
  


    
        


  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Your Page Title</title>
  
  <link rel="icon" type="image/x-icon" href="/ff01.png">
  </head>

  <body class="ma0 avenir bg-near-white production">

    

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/japanese/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Schrodin&#39;s Diary on Quantum Computing and Quantum Programming
      
    </a>
    <div class="flex-l items-center">
      
<h4></h4>
<ul class="pl0 mr3">
    
    <li class="list f5 f4-ns fw4 dib pr3">
        <a class="hover-white no-underline white-90" href="/awsbraketshor/">english</a>
    </li>
    
</ul>


      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>


    <main class="pb7" role="main">
      
  <div class="flex-l mt2 mw8 center">
    <article class="center cf pv5 ph3 ph4-ns mw7">
      <header>
        <h1 class="f1">
          AWSのAmazon Braketでショアのアルゴリズム
        </h1>
      </header>
      <div class="nested-copy-line-height lh-copy f4 nested-links mid-gray">
        <p>これまでの記事では以下の内容を学びました：</p>
<ul>
<li><a href="/japanese/learnqfteasily/">量子フーリエ変換を具体例で理解</a></li>
<li><a href="/japanese/qiskit20qft/">Qiskit 2.0で逆量子フーリエ変換</a></li>
<li><a href="/japanese/awsbraketqft/">Amazon Braket SDKで逆量子フーリエ変換</a></li>
<li><a href="/japanese/qiskit20qpe/">Qiskit 2.0で量子位相推定</a></li>
<li><a href="/japanese/awsbraketqpe/">Amazon Braket SDKで量子位相推定</a></li>
</ul>
<p>これらを踏まえてRSA暗号や、ビットコインのトランザクションで利用されるECDSA暗号を破ると言われている量子アルゴリズムであるショアのアルゴリズムについて学びます。</p>
<hr>
<h4 id="amazon-braket学習コース">Amazon Braket学習コース</h4>
<p>この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。</p>
<div style="display: flex; align-items: center;">
  <a href="https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8" target="_blank" style="margin-right: 20px;">
    <img src="/mycourses/AWSCourse.webp" alt="QiskitCourseJa" width="280" style="vertical-align: middle;">
  </a>
  <div style="word-break: break-all; font-size: 90%;">
    <a href="https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8" target="_blank">
      https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8
    </a>
  </div>
</div>
<p>量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。
こちらも利用し、量子技術のスキルを身につけましょう！</p>
<hr>
<h4 id="はじめての量子コンピューター入門基礎知識qiskitでの実装量子機械学習-全て学べる">はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】</h4>
<p>量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。</p>
<div style="display: flex; align-items: center;">
  <a href="https://www.udemy.com/course/intro-to-quantum-computing/?referralCode=7D8FB30849B8F69EC4C0" target="_blank" style="margin-right: 20px;">
    <img src="/mycourses/IntroQuantumComputing.webp" alt="QiskitCourseJa" width="225" style="vertical-align: middle;">
  </a>
  <div style="word-break: break-all; font-size: 90%;">
    <a href="https://www.udemy.com/course/intro-to-quantum-computing/?referralCode=7D8FB30849B8F69EC4C0" target="_blank">
      はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】
    </a>
  </div>
</div>
<br>
<hr>
<h1 id="ショアのアルゴリズム">ショアのアルゴリズム</h1>
<p>量子コンピューターで十分な数の量子ビットが扱えるようになった場合、ショアのアルゴリズムでRSA暗号や、ECDSA暗号が破られる危険性があると言われています。
例えばRSA暗号は大きな数の素因数分解が困難であることを利用した暗号方式ですが、今回はショアのアルゴリズムで素因数分解を行う例についてみていきましょう。
このアルゴリズムを用いて整数$N$の素因数分解を行う際の流れは以下の通りです。
<br><br>
<em><strong>$1 &lt; a &lt; N$ かつ$ N$との最大公約数が  $1$ となる$a$を選ぶ</strong></em>
<br>
　　　　　<em><strong>$\downarrow$</strong></em>
<br>
<em><strong>$a^x\bmod\ N$ という関数の周期 $r$を見つける</strong></em>
<br>
　　　　　<em><strong>$\downarrow$</strong></em>
<br>
<em><strong>$a^{\frac{r}{2}} \pm 1$の最大公約数からNの素因数を求める</strong></em>
<br><br></p>
<p>ここで&quot;$a^x\bmod\ N$ という関数の周期 $r$を見つける&quot;と記載されていますが、具体例を見ていきましょう。</p>
<p>例として$N=39$を素因数分解する際に、$a=5$を選んだ場合について考えます。$a^x\bmod\ N\ =\ 5^x\bmod\ 39$のグラフは$x$を横軸とすると次の通りとなります。</p>
<figure><img src="/Shor/axmodN.webp"
    alt="axmodN" width="800px">
</figure>

<p>y軸の値を書き出すと以下の通りで、4回の変化を通じて元の値に戻る周期関数であることがわかります。</p>
<p>$$
1 \rightarrow 5 \rightarrow 25 \rightarrow 8 \rightarrow 1 \rightarrow 5 \rightarrow 25 \rightarrow 8
\tag{1}
$$</p>
<p>この周期が位数$r$となり、この場合は4回で元の値に戻るため、$r=4$を持つことがわかります。
ショアのアルゴリズムでは、この$r$を量子コンピュータで計算することで高速に因数分解を行います。</p>
<p>ここでショアのアルゴリズムの実装については$a^x\bmod\ N$の関数を量子回路に直接定義し利用する、汎用性があり実装が複雑な<a href="https://arxiv.org/pdf/2311.08555">方法</a>か、特定の $a, N$のペアに対しての$a^x\bmod\ N$の変化の結果から演算子を定義し利用する、より簡単な実装方法が存在します。</p>
<p>今回は特定の$a, N$のペアに対して実装する、より簡単な方法について説明します。</p>
<p>まずは下準備です。
$a^x\bmod\ N$という周期関数の変化をもたらす演算子は次のように表現できます。</p>
<p>$$
U |y\rangle = |a y\bmod\ N\rangle
\tag{2}
$$</p>
<p>これについて例を見て確認しましょう。例として既に登場した$N=39$で$a=5$のケースで考えます。この場合、式は以下の通りとなります。</p>
<p>$$
U |y\rangle = |5 y\bmod\ 39\rangle
$$</p>
<p>$y = 1$を代入した場合以下の通りとなります。</p>
<p>$$
U |1\rangle = |5 \cdot 1\bmod\ 39\rangle = |5\rangle
$$</p>
<p>この結果を再び$y$に代入すると以下の通りとなります。</p>
<p>$$
U |5\rangle = |5 \cdot 5\bmod\ 39\rangle = |25\rangle
$$</p>
<p>再度この結果を代入しましょう。</p>
<p>$$
U |25\rangle = |5 \cdot 25\bmod\ 39\rangle = |8\rangle
$$</p>
<p>再び代入します。</p>
<p>$$
U |8\rangle = |5 \cdot 8\bmod\ 39\rangle = |1\rangle
$$</p>
<p>結果が $1$に戻りました！</p>
<p>確かにこの演算子により、(1)の変化を再現できており、この演算子を使えば位数rが求められるかもしれないと期待できます。(すでにこの時点で位数rの値はわかっているかもしれませんが、量子回路から回答を導くことが目的となるため、わからないふりをしておきます。)</p>
<p>ここで、(2)を満たす$U$の固有値は、固有状態を$|u_s\rangle$とした時、以下となることが知られています。</p>
<p>$$
U|u_s\rangle =\ e^{\frac{2\pi i s}{r}}|u_s\rangle
$$</p>
<p>これは、<a href="/japanese/awsbraketqpe/">量子位相推定アルゴリズム</a>により解を導ける形ですね！
さらにこの演算子の固有状態は以下で表せます。</p>
<p>$$
|u_s\rangle =
\frac{1}{\sqrt{r}}
\sum_{k=0}^{r-1}
e^{-\frac{2\pi i s k}{r}}<br>
\bigl|a^{k}\bmod N\bigr\rangle
\quad (s = 0,1,\dots,r-1)
$$</p>
<p>この固有状態について、$r=4$などの値を代入し、実際に足し合わせてみてもわかりますが、全ての$s$について$|u_s\rangle$を足し合わせると $|1\rangle$となります。</p>
<p>$$
|1\rangle = \frac{1}{\sqrt{r}} ( |u_0\rangle + |u_1\rangle +&hellip;.. |u_{r-1}\rangle )
$$</p>
<p><a href="/japanese/awsbraketqpe/">量子位相推定アルゴリズム</a>では、固有状態を量子ビットで定義することで、その固有状態に対する固有値を求めることができたのでした。
これらの性質より、固有状態を定義するビットを$|1\rangle$と設定し量子位相推定を実行することで、以下のような固有値の重ね合わせ$|\psi\rangle$が得られます。ここで、$n$は読み出しレジスタの量子ビット数です。</p>
<p>$$
|\psi\rangle = \frac{1}{\sqrt{r}} ( |2^n\cdot\frac{0}{r}\rangle + |2^n\cdot\frac{1}{r}\rangle +&hellip; + |2^n\cdot\frac{r - 1}{r}\rangle )
$$</p>
<p>この中に、rの情報も含まれているので$|\psi\rangle$を観測すれば結果からrを推定することができます。</p>
<p>この方法の流れをまとめると以下の通りとなります。
<br><br>
<em><strong>対象の$a, N$について、$U |y\rangle = |a y\bmod\ N\rangle$の変化をもたらす $U$を定義する</strong></em>
<br>
　　　　　<em><strong>$\downarrow$</strong></em>
<br>
<em><strong>固有状態の重ね合わせである$|1\rangle$と $U$について量子位相推定を行う</strong></em>
<br>
　　　　　<em><strong>$\downarrow$</strong></em>
<br>
<em><strong>観測結果から $r$を推定する</strong></em>
<br><br></p>
<p>実際に試してみましょう！</p>
<h2 id="amazon-braket-sdkでの実装">Amazon Braket SDKでの実装</h2>
<p>せっかくなのでより大きい値である$N=341$を素因数分解の対象としましょう。
また、$a=32$と今回設定し、実装します。
まずは$a=32, N=341$について、$U |y\rangle = |a y\bmod\ N\rangle$の変化をもたらす $U$を定義します。$y=1$を代入すると次のような結果が得られます。
$$
U |1\rangle = |32 \cdot 1\bmod\ 341\rangle = |32\rangle
$$
この結果を再度$y$に代入します。
$$
U |32\rangle = |32 \cdot 32\bmod\ 341\rangle = |1\rangle
$$
$|1\rangle$に戻りました！よって変化としては以下の通り記載できます。</p>
<p>$$
|1\rangle \rightarrow |32\rangle \rightarrow |1\rangle \rightarrow |32\rangle \rightarrow |1\rangle
\tag{3}
$$
この変化をもたらす $U$は固有状態レジスタの6番目の量子ビットにXゲートを適用することで定義できます。
ではこの $U$と、$|1\rangle$について量子位相推定アルゴリズムを実施しましょう。まずは<a href="/japanese/awsbraketqpe/">こちら</a>で紹介されているコードの通り、読み出しレジスタにHゲートを適用するところまで記載します。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> braket.circuits <span style="color:#f92672">import</span> Circuit
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> braket.devices <span style="color:#f92672">import</span> LocalSimulator
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> braket.experimental.algorithms.quantum_fourier_transform <span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    quantum_fourier_transform <span style="color:#66d9ef">as</span> qft_module
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n_readout_qubits <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>circ <span style="color:#f92672">=</span> Circuit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> qubit <span style="color:#f92672">in</span> list(range(n_readout_qubits)):
</span></span><span style="display:flex;"><span>    circ<span style="color:#f92672">.</span>h(qubit)
</span></span></code></pre></div><p>この後、$|1\rangle$を次のように定義します。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>circ<span style="color:#f92672">.</span>x(n_readout_qubits)
</span></span></code></pre></div><p>では、(3)の変化をもたらす制御$U$ゲートを、量子位相推定アルゴリズムの規則で適用します。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>n_eigenstate_qubits <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ctl_bit <span style="color:#f92672">in</span> list(range(n_readout_qubits)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> list(range(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span>(ctl_bit))):
</span></span><span style="display:flex;"><span>        circ<span style="color:#f92672">.</span>cnot(ctl_bit, n_readout_qubits <span style="color:#f92672">+</span> n_eigenstate_qubits <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><p>最後に逆量子フーリエ変換です。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>circ<span style="color:#f92672">.</span>swap(<span style="color:#ae81ff">0</span>,n_readout_qubits <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>circ<span style="color:#f92672">.</span>iqft(range(n_readout_qubits))
</span></span><span style="display:flex;"><span>circ<span style="color:#f92672">.</span>measure([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>device <span style="color:#f92672">=</span> LocalSimulator()
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> device<span style="color:#f92672">.</span>run(circ, shots<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>)<span style="color:#f92672">.</span>result()
</span></span><span style="display:flex;"><span>counts <span style="color:#f92672">=</span> result<span style="color:#f92672">.</span>measurement_counts
</span></span><span style="display:flex;"><span>print(counts)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Output</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Counter({&#39;000&#39;: 501, &#39;100&#39;: 499})</span>
</span></span></code></pre></div><p>このような結果からrを推定するコードについては<a href="https://github.com/amazon-braket/amazon-braket-algorithm-library/blob/main/src/braket/experimental/algorithms/shors/shors.py">こちらの<code>get_factors_from_results()</code></a>が参考となります。
今回は結果から、$r=2$が推定できます。
こちらの$r$を用いれば、$a^{\frac{r}{2}} + 1 = 33$、$a^{\frac{r}{2}} - 1 = 31$と求まります。</p>
<p>そしてこの2つの数と341との最大公約数は以下の通りです。</p>
<p>$$
\begin{align}
gcd(33, 341) = 11 \\
gcd(31, 341) = 31
\end{align}
$$
無事に341の素因数が11、31と求まりました！</p>
<hr>
<h4 id="amazon-braket学習コース-1">Amazon Braket学習コース</h4>
<p>この記事で登場する、量子ゲートや量子回路など、量子コンピュータの基本的な知識や、Amazon Braketの使い方についてはこちらのコースで効率的に学べます。</p>
<div style="display: flex; align-items: center;">
  <a href="https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8" target="_blank" style="margin-right: 20px;">
    <img src="/mycourses/AWSCourse.webp" alt="QiskitCourseJa" width="280" style="vertical-align: middle;">
  </a>
  <div style="word-break: break-all; font-size: 90%;">
    <a href="https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8" target="_blank">
      https://www.udemy.com/course/quantum-computing-on-aws-for-beginners-amazon-braket/?referralCode=F361C3FD774489A1B5B8
    </a>
  </div>
</div>
<p>量子コンピュータやAWSの知識が無い方でも学び始められ、最終的には量子機械学習についても学べます。
こちらも利用し、量子技術のスキルを身につけましょう！</p>
<hr>
<h4 id="はじめての量子コンピューター入門基礎知識qiskitでの実装量子機械学習-全て学べる-1">はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】</h4>
<p>量子コンピューターの入門コースを作成しました。このコースにより、量子コンピューターの基礎知識、Qiskitでの実装、量子機械学習について学べます。</p>
<div style="display: flex; align-items: center;">
  <a href="https://www.udemy.com/course/intro-to-quantum-computing/?referralCode=7D8FB30849B8F69EC4C0" target="_blank" style="margin-right: 20px;">
    <img src="/mycourses/IntroQuantumComputing.webp" alt="QiskitCourseJa" width="225" style="vertical-align: middle;">
  </a>
  <div style="word-break: break-all; font-size: 90%;">
    <a href="https://www.udemy.com/course/intro-to-quantum-computing/?referralCode=7D8FB30849B8F69EC4C0" target="_blank">
      はじめての量子コンピューター入門【基礎知識・Qiskitでの実装・量子機械学習 全て学べる】
    </a>
  </div>
</div>
<br>
<hr>

      </div>
    </article>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://schrodinteq.github.io/japanese/" >
    &copy;  Schrodin's Diary on Quantum Computing and Quantum Programming 2025 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>

